{"version":3,"sources":["App.tsx","index.tsx"],"names":["App","props","sourceWorker","state","sourceWorkerInit","bind","this","onmessage","Worker","postMessage","type","location","window","toString","e","message","data","console","log","url","URL","setState","loading","nodesLength","startIndex","endIndex","Math","min","loaded","nodes","loadedLengthBytes","map","node","index","key","JSON","stringify","Component","ReactDOM","render","document","getElementById"],"mappings":"0LAsGeA,E,YAhFb,WAAYC,GAAY,IAAD,8BACrB,4CAAMA,KAHRC,kBAEuB,EAGrB,EAAKC,MAAQ,GAEb,EAAKC,iBAAmB,EAAKA,iBAAiBC,KAAtB,gBACxB,EAAKD,mBANgB,E,gFAUrBE,KAAKC,UAAYD,KAAKC,UAAUF,KAAKC,MACrCA,KAAKJ,aAAe,IAAIM,OAAO,wBAC/BF,KAAKJ,aAAaK,UAAYD,KAAKC,UACnCD,KAAKJ,aAAaO,YAAY,CAC5BC,KAAM,WACNC,SAAUC,OAAOD,SAASE,e,gCAIpBC,GACR,IAAMC,EAAsBD,EAAEE,KAC9BC,QAAQC,IAAI,uBAAwBH,GACf,cAAjBA,EAAQL,MACVJ,KAAKJ,aAAaO,YAAY,CAC5BC,KAAM,cACNS,IAAK,IAAIC,IAAI,cAAeR,OAAOD,SAASE,YAAYA,aAGvC,YAAjBE,EAAQL,OACVJ,KAAKe,SAAS,CACZC,QAASP,IAEPA,EAAQQ,YAAc,GACxBjB,KAAKJ,aAAaO,YAAY,CAC5BC,KAAM,oBACNc,WAAY,EACZC,SAAUC,KAAKC,IAAI,IAAKZ,EAAQQ,gBAIjB,WAAjBR,EAAQL,OACVJ,KAAKe,SAAS,CACZO,OAAQb,IAEVT,KAAKJ,aAAaO,YAAY,CAC5BC,KAAM,oBACNc,WAAY,EACZC,SAAUC,KAAKC,IAAI,IAAKZ,EAAQQ,gBAGf,uBAAjBR,EAAQL,MACVJ,KAAKe,SAAS,CACZQ,MAAOd,EAAQc,U,+BAKX,IAAD,EAC4BvB,KAAKH,MAAhCyB,EADD,EACCA,OAAQN,EADT,EACSA,QAASO,EADlB,EACkBA,MAEzB,OACE,6BACE,sGAIA,qFACA,6BAAMP,GAAWA,EAAQQ,mBACzB,6BAAMF,GAAU,QAChB,6BACGC,GACCA,EAAME,KAAI,SAACC,EAAiBC,GAC1B,OAAO,yBAAKC,IAAKD,GAAQE,KAAKC,UAAUJ,a,GA3EpCK,aCflBC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,U","file":"static/js/main.87518693.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  MessageOut,\n  MessageOutLoading,\n  MessageOutLoaded,\n  MessageInInitSax,\n  MessageInLoad,\n  MessageInGetRange,\n  NodeTypes\n} from \"doctored-worker\";\n\ntype Props = {};\n\ntype State = {\n  loading?: MessageOutLoading | undefined;\n  loaded?: MessageOutLoaded | undefined;\n  nodes?: NodeTypes[] | undefined;\n};\n\nclass App extends Component<Props, State> {\n  sourceWorker: any;\n\n  constructor(props: {}) {\n    super(props);\n\n    this.state = {};\n\n    this.sourceWorkerInit = this.sourceWorkerInit.bind(this);\n    this.sourceWorkerInit();\n  }\n\n  sourceWorkerInit() {\n    this.onmessage = this.onmessage.bind(this);\n    this.sourceWorker = new Worker(\"./doctored.worker.js\");\n    this.sourceWorker.onmessage = this.onmessage;\n    this.sourceWorker.postMessage({\n      type: \"init-sax\",\n      location: window.location.toString()\n    } as MessageInInitSax);\n  }\n\n  onmessage(e: { data: MessageOut }) {\n    const message: MessageOut = e.data;\n    console.log(\"UI Thread Received: \", message);\n    if (message.type === \"sax-ready\") {\n      this.sourceWorker.postMessage({\n        type: \"load-source\",\n        url: new URL(\"./large.xml\", window.location.toString()).toString()\n      } as MessageInLoad);\n    }\n    if (message.type === \"loading\") {\n      this.setState({\n        loading: message\n      });\n      if (message.nodesLength > 0) {\n        this.sourceWorker.postMessage({\n          type: \"get-range/request\",\n          startIndex: 0,\n          endIndex: Math.min(100, message.nodesLength)\n        } as MessageInGetRange);\n      }\n    }\n    if (message.type === \"loaded\") {\n      this.setState({\n        loaded: message\n      });\n      this.sourceWorker.postMessage({\n        type: \"get-range/request\",\n        startIndex: 0,\n        endIndex: Math.min(100, message.nodesLength)\n      } as MessageInGetRange);\n    }\n    if (message.type === \"get-range/response\") {\n      this.setState({\n        nodes: message.nodes\n      });\n    }\n  }\n\n  render() {\n    const { loaded, loading, nodes } = this.state;\n\n    return (\n      <div>\n        <p>\n          Loading and parsing an 80MB XML file in a background thread using\n          WASM.\n        </p>\n        <p>Open your dev console to see messages between threads.</p>\n        <div>{loading && loading.loadedLengthBytes}</div>\n        <div>{loaded && \"DONE\"}</div>\n        <div>\n          {nodes &&\n            nodes.map((node: NodeTypes, index: number) => {\n              return <div key={index}>{JSON.stringify(node)}</div>;\n            })}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}